---
layout: post
title: "Добавил Orphus"
date: 2013-08-30 17:44
comments: true
categories: 
---

Установил в блог [Orphus](http://orphus.ru/).
Теперь, если вы заметите ошибку или опечатку, просто выделите ее и нажмите Ctrl-Enter,
и мне в почтовый ящик придет о ней сообщение.

Добавляется он в Octopress без проблем, но по-умолчанию вешает на страницу свой довольно уродливый баннер.
Чтобы его выпилить поступаем так:

<!-- more -->

 * Вставляем на страницу код Орфуса. Вырезаем там теги A и IMG.
 * Кладем куда надо `orphus.js` и `orphus.gif`
 * Исправляем `orphus.js` как показано ниже.

Заглянем в `orphus.js`. Выглядит он неважно, т.к. его прогнали через какой-нибудь uglifier, но исправить его
достаточно легко. Если просто удалить ссылку на gif-файл без модификации скрипта, у нас начнет вылезать ошибка "Wrong installation code". Путем поиска несложно найти функцию, которая ее выдает. В моем случае это `_5e()`.
Далее ищем где еще вызывается эта функция, и видим, что она вызывается в отдельном небольшом куске кода, который
проверяет всякие вещи и вызывает ее с разными параметрами (который приводят к разным сообщениям).
В моем случае этот кусок начинается со строки `var _60=_15();` и заканчивается перед строкой `var _63=_50();`.

Удаляем, проверяем -- молча не работает. Добавляем обратно ссылку на GIF -- работает. Видимо, есть еще какая-то ссылка на
картинку. Еще немного поглядев код несложно убедиться, что это функция `_15()`, которая используется еще в двух местах:
 * В тексте, рисующем формочку -- меняем тут ее вызов на прямую ссылку на GIF
 * Еще в одном месте (в моем случае -- в функции `_14()`). По всей видимости, в этом месте назначается обработчик клика по картинке, и в отсутствие ее он просто молча игнорируется. По крайней мере, у меня все заработало и без исправления этой части скрипта.

